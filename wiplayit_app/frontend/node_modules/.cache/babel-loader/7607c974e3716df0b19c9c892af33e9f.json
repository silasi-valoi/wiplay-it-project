{"ast":null,"code":"var _jsxFileName = \"/home/silasi/Deprojectos/javascript_projects/wiplay-it-web-frontend/src/containers/authentication/index.js\";\nimport React from 'react';\nimport { DefaultWrongPage } from \"components/partial_components\";\nimport Axios from 'axios_instance';\nimport { connect } from 'react-redux';\nimport { compose } from 'redux';\nimport { FORM_CHANGE, LOGIN_USER, CREATE_USER, PASSWORD_REST } from 'actions/types';\nimport * as action from 'actions/actionCreators';\nimport { store } from 'index';\nimport Api from 'api';\nimport Helper from 'containers/utils/helpers';\nimport { getCurrentUser } from 'dispatch/index';\nconst helper = new Helper();\nconst api = new Api();\nexport function withAuthentication(Component) {\n  var _temp;\n\n  return _temp = class Authentication extends React.Component {\n    constructor(_props) {\n      super(_props);\n\n      this.onStoreUpdate = () => {};\n\n      this.responseTwitter = response => {\n        console.log(response); //var accessToken =  response.accessToken\n        //var apiUrl =  api.twitterLoginApi(this)\n        //this.socialLogin(apiUrl, accessToken)\n      };\n\n      this.responseGoogle = response => {\n        console.log(response); //var accessToken =  response.accessToken\n        //var apiUrl =  api.googleLoginApi(this)\n        //this.socialLogin(apiUrl, accessToken)\n      };\n\n      this.toggleSignUpForm = props => {\n        console.log(props);\n        console.log(props, this.props);\n        this.props.toggleSignUp(props);\n        this.forceUpdate();\n      };\n\n      this.togglePasswordResetForm = props => {\n        console.log(props, this.props);\n        this.props.togglePasswordReset(props);\n        this.forceUpdate();\n      };\n\n      this.getAuthUrl = formValues => {\n        if (formValues.email && formValues.password && !formValues.password2 && !formValues.first_name) {\n          return api.logginUser();\n        } else if (formValues.first_name && formValues.last_name) {\n          return api.createUser();\n        } else if (formValues.password2 && formValues.password1) {\n          return api.passwordChangeApi();\n        } else {\n          return api.passwordResetApi();\n        }\n      };\n\n      this.onSubmit = (values, dispatch) => {\n        const axiosApi = new Axios();\n        var state = this.props.state;\n        let apiUrl = this.getAuthUrl(values);\n        console.log(this.getAuthUrl(values));\n        let tokenKey = null;\n        let with_token = false;\n        const instance = axiosApi.axiosInstance(false);\n        store.dispatch(action.authenticationPending());\n        return instance.post(apiUrl, values).then(response => dispatch(action.authenticationSuccess(response.data))).catch(error => {\n          if (error.response && error.response.data) {\n            dispatch(action.authenticationError(error.response.data));\n          } else if (error.request) {\n            dispatch(action.handleError());\n          }\n        });\n      };\n\n      this.state = {\n        isAuthenticated: false\n      };\n      this.onSubmit = this.onSubmit.bind(this);\n      this.responseFacebook = this.responseFacebook.bind(this);\n      this.responseTwitter = this.responseTwitter.bind(this);\n      this.responseGoogle = this.responseGoogle.bind(this);\n    }\n\n    isAuthenticated() {\n      let cachedEntyties = JSON.parse(localStorage.getItem('@@CachedEntyties'));\n      console.log(cachedEntyties);\n\n      if (cachedEntyties) {\n        let auth = cachedEntyties.auth;\n\n        if (auth && auth.isLoggedIn) {\n          this.props.history.push('/');\n          this.props.forceUpdate();\n          return true;\n        }\n      }\n\n      return false;\n    }\n\n    Redirect() {\n      let cachedEntyties = JSON.parse(localStorage.getItem('@@CachedEntyties'));\n\n      if (cachedEntyties) {\n        let auth = cachedEntyties.auth;\n        store.dispatch(getCurrentUser(auth.tokenKey));\n        let currentUser = cachedEntyties.currentUser;\n\n        if (!currentUser) {\n          store.dispatch(getCurrentUser(auth.tokenKey));\n        }\n\n        if (auth && auth.isLoggedIn) {\n          this.props.history.push('/');\n        }\n      }\n    }\n\n    responseFacebook(response) {\n      //console.log(response.accessToken);\n      var accessToken = response.accessToken;\n      var formData = new FormData();\n      console.log(accessToken);\n      formData.append(\"access_token\", accessToken);\n      var apiUrl = api.facebookLoginApi(this);\n    }\n\n    componentDidUpdate(nextProps, prevState) {\n      console.log(nextProps, prevState);\n    }\n\n    componentDidMount() {\n      const onStoreChange = () => {\n        let onStoreUpdate = store.getState();\n        var userAuth = onStoreUpdate.userAuth;\n\n        if (userAuth && userAuth.auth && userAuth.auth.isLoggedIn) {\n          console.log(userAuth); //this.Redirect();\n        }\n      };\n\n      this.unsubscribe = store.subscribe(onStoreChange);\n    }\n\n    componentWillUnmount() {\n      this.unsubscribe();\n    }\n\n    componentWillReceiveProps(nextProps) {\n      console.log(nextProps);\n      /*\n      let  userAuth = store.getState().userAuth;\n      let cachedEntyties = JSON.parse(localStorage.getItem('@@CachedEntyties'));\n       console.log(cachedEntyties, userAuth)\n       let { currentUser }  = cachedEntyties;\n       if (userAuth.auth.isLoggedIn && !currentUser) {\n          let isOnStorage = localStorage.getItem('auth' )?true : false;\n           if (isOnStorage) {\n             let auth = JSON.parse(localStorage.getItem('auth'))\n             store.dispatch(getCurrentUser(auth.tokenKey));\n             currentUser = localStorage.getItem('currentUser')?true:false;\n               if (currentUser) {\n                  setTimeout( () => {\n                   this.props.history.push('/');\n                   this.setState({isAuthenticated:currentUser })\n                }, 100);\n              }\n          }\n      }    */\n    }\n\n    getProps() {\n      let props = {\n        onSubmit: this.onSubmit,\n        responseFacebook: this.responseFacebook,\n        responseGoogle: this.responseGoogle,\n        responseTwitter: this.responseTwitter,\n        togglePasswordResetForm: this.togglePasswordResetForm,\n        toggleSignUpForm: this.toggleSignUpForm\n      };\n      return Object.assign(props, this.props);\n    }\n\n    render() {\n      let props = this.getProps();\n      console.log(props);\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243\n        },\n        __self: this\n      }, React.createElement(Component, Object.assign({}, props, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 244\n        },\n        __self: this\n      }))));\n    }\n\n  }, _temp;\n} //binds on `props` change\n\nconst mapDispatchToProps = (dispatch, ownProps) => {\n  return {\n    togglePasswordReset: (self, props) => dispatch(action.togglePasswordResetForm(self, props)),\n    toggleSignUp: (self, props) => dispatch(action.toggleSignUpForm(self, props))\n  };\n};\n\nconst mapStateToProps = (state, ownProps) => {\n  return {\n    userAuth: state.entyties.userAuth\n  };\n};\n\nconst composedHoc = compose(connect(mapStateToProps, mapDispatchToProps), withAuthentication);\nexport default composedHoc;","map":{"version":3,"sources":["/home/silasi/Deprojectos/javascript_projects/wiplay-it-web-frontend/src/containers/authentication/index.js"],"names":["React","DefaultWrongPage","Axios","connect","compose","FORM_CHANGE","LOGIN_USER","CREATE_USER","PASSWORD_REST","action","store","Api","Helper","getCurrentUser","helper","api","withAuthentication","Component","Authentication","constructor","props","onStoreUpdate","responseTwitter","response","console","log","responseGoogle","toggleSignUpForm","toggleSignUp","forceUpdate","togglePasswordResetForm","togglePasswordReset","getAuthUrl","formValues","email","password","password2","first_name","logginUser","last_name","createUser","password1","passwordChangeApi","passwordResetApi","onSubmit","values","dispatch","axiosApi","state","apiUrl","tokenKey","with_token","instance","axiosInstance","authenticationPending","post","then","authenticationSuccess","data","catch","error","authenticationError","request","handleError","isAuthenticated","bind","responseFacebook","cachedEntyties","JSON","parse","localStorage","getItem","auth","isLoggedIn","history","push","Redirect","currentUser","accessToken","formData","FormData","append","facebookLoginApi","componentDidUpdate","nextProps","prevState","componentDidMount","onStoreChange","getState","userAuth","unsubscribe","subscribe","componentWillUnmount","componentWillReceiveProps","getProps","Object","assign","render","mapDispatchToProps","ownProps","self","mapStateToProps","entyties","composedHoc"],"mappings":"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","sourcesContent":["import React from 'react';\n\nimport {DefaultWrongPage} from \"components/partial_components\"\nimport Axios from 'axios_instance';\nimport { connect } from 'react-redux';\nimport { compose } from 'redux';\nimport { FORM_CHANGE, LOGIN_USER, CREATE_USER,PASSWORD_REST } from 'actions/types';\nimport  * as action  from 'actions/actionCreators';\n\nimport { store } from 'index';\nimport Api from 'api';\nimport Helper from 'containers/utils/helpers';\nimport { getCurrentUser } from 'dispatch/index';\n           \n\n\n\nconst helper   = new Helper();\nconst api = new Api();\n\n\n\n\n\nexport function withAuthentication(Component) {\n\n    return class Authentication extends React.Component {\n\n        constructor(props) {\n            super(props);\n            this.state = {\n            isAuthenticated : false,\n            };\n\n            this.onSubmit            = this.onSubmit.bind(this);\n            this.responseFacebook    = this.responseFacebook.bind(this);\n            this.responseTwitter     = this.responseTwitter.bind(this);\n            this.responseGoogle      = this.responseGoogle.bind(this);     \n        }\n\n\n        isAuthenticated() {\n            let cachedEntyties = JSON.parse(localStorage.getItem('@@CachedEntyties'));\n            console.log(cachedEntyties)\n\n            if (cachedEntyties){\n                let { auth }  = cachedEntyties;\n\n                if (auth && auth.isLoggedIn){\n                    this.props.history.push('/')\n\n                    this.props.forceUpdate()\n                    return true\n                }\n            }\n\n            return false;\n        }\n\n        Redirect(){\n            let cachedEntyties = JSON.parse(localStorage.getItem('@@CachedEntyties'));\n\n            if (cachedEntyties){\n                let { auth }  = cachedEntyties;\n                store.dispatch(getCurrentUser(auth.tokenKey));\n\n                let {currentUser} = cachedEntyties;\n\n                if(!currentUser){\n                    store.dispatch(getCurrentUser(auth.tokenKey));\n\n                }\n\n                if (auth && auth.isLoggedIn){\n                    this.props.history.push('/')\n                }\n            }\n    }\n\n        responseFacebook(response) {\n           //console.log(response.accessToken);\n           var accessToken =  response.accessToken\n           var formData = new FormData();\n           console.log(accessToken)\n          \n           formData.append(\"access_token\",accessToken);\n      \n           var apiUrl =  api.facebookLoginApi(this)\n\n        }\n\n\n        onStoreUpdate = () =>{\n         \n        };\n\n\n        componentDidUpdate(nextProps , prevState){\n            console.log(nextProps, prevState)\n       };\n\n\n    componentDidMount() {\n        const onStoreChange = () => {\n        let  onStoreUpdate = store.getState();   \n        var userAuth = onStoreUpdate.userAuth;\n\n            if(userAuth && userAuth.auth && userAuth.auth.isLoggedIn){\n                console.log(userAuth)\n               //this.Redirect();\n            }\n       };\n\n        this.unsubscribe = store.subscribe(onStoreChange);\n                    \n      };\n\n\n    componentWillUnmount() {\n        this.unsubscribe();\n\n      };\n\n\n    componentWillReceiveProps(nextProps){\n        console.log(nextProps)\n        /*\n        let  userAuth = store.getState().userAuth;\n        let cachedEntyties = JSON.parse(localStorage.getItem('@@CachedEntyties'));\n\n        console.log(cachedEntyties, userAuth)\n\n        let { currentUser }  = cachedEntyties;\n\n        if (userAuth.auth.isLoggedIn && !currentUser) {\n            let isOnStorage = localStorage.getItem('auth' )?true : false;\n\n            if (isOnStorage) {\n               let auth = JSON.parse(localStorage.getItem('auth'))\n               store.dispatch(getCurrentUser(auth.tokenKey));\n               currentUser = localStorage.getItem('currentUser')?true:false;\n\n                if (currentUser) {\n                    setTimeout( () => {\n                     this.props.history.push('/');\n                     this.setState({isAuthenticated:currentUser })\n                  }, 100);\n                }\n            }\n        }    */   \n    };\n\n        responseTwitter = (response) => {\n            console.log(response);\n            //var accessToken =  response.accessToken\n            //var apiUrl =  api.twitterLoginApi(this)\n           //this.socialLogin(apiUrl, accessToken)\n        }\n\n\n        responseGoogle = (response)=> {\n           console.log(response);\n           //var accessToken =  response.accessToken\n           //var apiUrl =  api.googleLoginApi(this)\n           //this.socialLogin(apiUrl, accessToken)\n        };\n\n        toggleSignUpForm = (props)=>{\n           console.log(props)\n           console.log(props, this.props)\n           this.props.toggleSignUp(props)\n           this.forceUpdate()\n        }\n\n        togglePasswordResetForm = (props)=>{\n           console.log(props, this.props)\n           this.props.togglePasswordReset(props)\n           this.forceUpdate()\n        };\n      \n      \n    getAuthUrl = (formValues)=>{\n        \t\n       \tif (formValues.email && formValues.password &&\n            !formValues.password2 && !formValues.first_name){\n\n       \t\treturn api.logginUser();\n       \t}\n        \t\n       \telse if (formValues.first_name && formValues.last_name){\n       \t\treturn api.createUser();\n       \t}\n       \telse if (formValues.password2 && formValues.password1){\n       \t\treturn api.passwordChangeApi();\n       \t} \n        \t\n       \telse{\n            return  api.passwordResetApi();\n    \t}\n    };\n\n    onSubmit = (values, dispatch) => {\n        const axiosApi = new Axios();\n        var state = this.props.state;\n        let apiUrl =  this.getAuthUrl(values);\n        console.log(this.getAuthUrl(values))\n        let tokenKey   = null;\n        let with_token = false;\n        const instance = axiosApi.axiosInstance(false);\n        store.dispatch(action.authenticationPending()) \n         \n        return  instance.post(apiUrl, values)\n            .then(response => dispatch(action.authenticationSuccess(response.data)))\n            .catch(error =>{\n                if (error.response && error.response.data) {\n                    dispatch(action.authenticationError(error.response.data));\n                  }else if (error.request) {\n                     dispatch(action.handleError())\n                  }\n               }); \n      }\n      \n      getProps() {\n        let  props = {\n            onSubmit : this.onSubmit, \n            responseFacebook        : this.responseFacebook,\n            responseGoogle          : this.responseGoogle,\n            responseTwitter         : this.responseTwitter,\n            togglePasswordResetForm : this.togglePasswordResetForm, \n            toggleSignUpForm        : this.toggleSignUpForm,\n        };\n         \n        return Object.assign(props, this.props);\n      }\n    \n\n        render() {\n            let props = this.getProps(); \n            console.log(props)\n\n            return (\n               <div>\n                    <div>\n                     <Component {...props}/>\n                  </div>  \n                </div>\n            );\n        }\n    }\n}\n\n\n//binds on `props` change\nconst mapDispatchToProps = (dispatch, ownProps) => {\n     \n   return {\n     togglePasswordReset  : (self , props)    => dispatch(action.togglePasswordResetForm(self, props)),\n     toggleSignUp         : (self , props)    => dispatch(action.toggleSignUpForm(self , props)),\n     \n   }\n\n};\n\n\n\n\nconst mapStateToProps = (state, ownProps) => {\n   return {\n      userAuth : state.entyties.userAuth,\n      \n   }\n};\n\nconst composedHoc = compose( connect(mapStateToProps, mapDispatchToProps),withAuthentication )\n\n\nexport default  composedHoc;\n  \n\n\n"]},"metadata":{},"sourceType":"module"}