{"ast":null,"code":"var _jsxFileName = \"/home/silasi/Deprojectos/javascript_projects/wiplay-it-web-frontend/src/containers/higher-order-components/main.js\";\nimport React from 'react';\nimport { ModalManager } from 'react-dynamic-modal';\nimport { connect } from 'react-redux';\nimport { compose } from 'redux';\nimport { handleSubmit, getCurrentUser, getPost, getUserList, getUserProfile, getPostList, getQuestion, getReplyList, getReplyChildrenList, getQuestionList as _getQuestionList, getCommentList, getIndex } from \"dispatch/index\";\nimport * as action from 'actions/actionCreators';\nimport { ModalOptionsMenu } from \"components/buttons\";\nimport { DropImage } from \"containers/profile/edit_profile\";\nimport AppEditor from 'containers/editor';\nimport { store } from \"index\";\nimport Modals from \"containers/modal-conf\";\nimport Helper from 'containers/utils/helpers';\nconst helper = new Helper();\nexport function withMain(Component) {\n  var _temp;\n\n  return _temp = class Main extends Component {\n    constructor(_props) {\n      super(_props);\n\n      this.onStoreUpdate = () => {\n        const onStoreChange = () => {\n          let storeUpdate = store.getState(); //if (!storeUpdate.question.visited && storeUpdate.question.newObject) {\n          //   console.log('redirecting to question page')\n          // this.redirecToQuestionPage(storeUpdate.question) \n          // }\n          //Open the Modal whenever modal is true.\n\n          this.openModal(storeUpdate.modal);\n\n          if (this.state.modalIsOpen && this.props.history.action === \"POP\") {\n            if (this.state.modalIsOpen) {\n              store.dispatch(action.hideModal());\n            }\n          } else if (this.props.history && this.props.history.action === \"PUSH\") {//console.log(storeUpdate)\n          }\n        };\n\n        this.unsubscribe = store.subscribe(onStoreChange);\n      };\n\n      this.logout = () => {\n        localStorage.removeItem('@@CachedEntyties');\n\n        if (this.isAuthenticated()) {\n          localStorage.removeItem('@@CachedEntyties');\n          this.props.history.push('/user/registration');\n        } else {\n          localStorage.removeItem('@@CachedEntyties');\n          this.props.history.push('/user/registration');\n        }\n\n        ModalManager.close();\n      };\n\n      this.openModal = modal => {\n        //Open modal is open is true and close the if isOpen is false\n        //And most importantly render the modal with its contents based on the \n        //action dispatched \n        const modals = new Modals();\n\n        if (modal.isOpen) {\n          let modalProps = modal.modalProps ? modal.modalProps : {}; //Get Some important props and merge them with modalProps\n\n          let props = this.getProps();\n          Object.assign(props, modalProps);\n          console.log(modal);\n\n          if (modal.modalType === 'editor') {\n            modalProps['modalContents'] = React.createElement(AppEditor, Object.assign({}, props, {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 169\n              },\n              __self: this\n            }));\n            console.log(modal, modalProps);\n            modals.editorModal(modal.modalProps);\n            setTimeout(() => {\n              this.setState({\n                modalIsOpen: true\n              }); //this.props.history.push({},'')\n            }, 10);\n          } else if (modal.modalType === 'optionsMenu') {\n            modalProps['modalContents'] = React.createElement(ModalOptionsMenu, Object.assign({}, props, {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 179\n              },\n              __self: this\n            }));\n            modals.optionsMenuModal(modalProps);\n            setTimeout(() => {\n              this.setState({\n                modalIsOpen: true\n              }); //this.props.history.push({},'')\n            }, 10);\n          } else if (modal.modalType === 'dropImage') {\n            modalProps['modalContents'] = React.createElement(DropImage, Object.assign({}, props, {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 189\n              },\n              __self: this\n            }));\n            modals.dropImageModal(modalProps);\n            setTimeout(() => {\n              this.setState({\n                modalIsOpen: true\n              }); //this.props.history.push({},'')\n            }, 10);\n          }\n        } else {\n          this.setState({\n            modalIsOpen: false\n          });\n          ModalManager.close();\n        }\n      };\n\n      this.redirecToQuestionPage = questionObj => {\n        questionObj = questionObj.newObject;\n\n        if (questionObj) {\n          let path = \"/question/\".concat(questionObj.slug, \"/\");\n          let currentUser = this.state.currentUser;\n          this.props.history.push(path, {\n            questionObj,\n            currentUser,\n            isNeQuestion: true\n          });\n        }\n      };\n\n      this.state = {\n        currentUser: '',\n        isAuthenticated: localStorage.getItem('auth') ? true : false,\n        modalIsOpen: false\n      };\n    }\n\n    isAuthenticated() {\n      let cachedEntyties = JSON.parse(localStorage.getItem('@@CachedEntyties'));\n\n      if (cachedEntyties) {\n        let auth = cachedEntyties.auth;\n\n        if (auth && auth.isLoggedIn) {\n          return true;\n        }\n      }\n\n      return false;\n    } //static getDerivedStateFromError(error) {\n    // Update state so the next render will show the fallback UI.\n    // return  dispatch => action.handleError(error);\n    //}\n    //componentDidCatch(error, info) {\n    // You can also log the error to an error reporting service\n    // console.log(error, info);\n    // }\n\n    /*\n    componentWillMount() {\n      //localStorage.removeItem('questionList');        \n    }*/\n\n\n    componentWillUnmount() {\n      this.unsubscribe();\n    }\n\n    disableBack(e) {\n      if (this.state.modalIsOpen) {\n        e.returnValue = '';\n      }\n\n      e.preventDefault();\n    }\n\n    componentDidMount() {\n      this.onStoreUpdate(); //Subscribe on store change    \n\n      if (!this.isAuthenticated()) {\n        //User is not authenticated,so redirect to authentication page.\n        this.props.history.push('/user/registration/');\n      }\n\n      if (!this.getCurrentUser()) {\n        store.dispatch(getCurrentUser());\n      }\n    }\n\n    getCurrentUser() {\n      let cachedEntyties = JSON.parse(localStorage.getItem('@@CachedEntyties'));\n\n      if (cachedEntyties && cachedEntyties.currentUser) {\n        return cachedEntyties.currentUser.user;\n      }\n\n      return false;\n    }\n\n    unfollowOrDownVote(params) {\n      if (params.objName === \"question\" || params.objName === \"userProfile\" || params.objName === \"usersList\") {\n        var followers = params.obj.followers - 1;\n        params['formData'] = helper.createFormData({\n          followers\n        });\n      } else {\n        var upvotes = params.obj.upvotes - 1;\n        params['formData'] = helper.createFormData({\n          upvotes\n        });\n      }\n\n      this.props.submit(params); //handle subimiting downVotes or Unfollwers \n    }\n\n    followOrUpVote(params) {\n      if (params.objName === \"question\" || params.objName === \"userProfile\" || params.objName === \"usersList\") {\n        var followers = params.obj.followers + 1;\n        params['formData'] = helper.createFormData({\n          followers\n        });\n      } else {\n        var upvotes = params.obj.upvotes + 1;\n        params['formData'] = helper.createFormData({\n          upvotes\n        });\n      }\n\n      this.props.submit(params); //handle subimiting upvotes or follwers \n    }\n\n    push() {\n      this.props.history.pus(this.props, 'hello');\n    }\n\n    getProps() {\n      let props = {\n        logout: this.logout,\n        followOrUpVote: this.followOrUpVote.bind(this),\n        unfollowOrDownVote: this.unfollowOrDownVote.bind(this),\n        currentUser: this.getCurrentUser()\n      };\n      Object.assign(props, this.props);\n      return props;\n    }\n\n    render() {\n      let props = this.getProps();\n      console.log(props);\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 266\n        },\n        __self: this\n      }, React.createElement(Component, Object.assign({}, props, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 267\n        },\n        __self: this\n      })));\n    }\n\n  }, _temp;\n} //binds on `props` change\n\nconst mapDispatchToProps = (dispatch, ownProps) => {\n  return {\n    getIndex: () => dispatch(getIndex()),\n    getUserProfile: id => dispatch(getUserProfile(id)),\n    getUserList: props => dispatch(getUserList(props)),\n    getQuestionList: id => dispatch(_getQuestionList(id)),\n    getPostList: id => dispatch(getPostList(id)),\n    getQuestion: id => dispatch(getQuestion(id)),\n    getPost: id => dispatch(getPost(id)),\n    getCommentList: comment => dispatch(getCommentList(comment)),\n    getReplyList: props => dispatch(getReplyList(props)),\n    getReplyChildrenList: reply => dispatch(getReplyChildrenList(reply)),\n    getCurrentUser: apiUrl => dispatch(getCurrentUser()),\n    submit: props => dispatch(handleSubmit(props)),\n    showModal: props => dispatch(action.showModal(props)),\n    hideModal: props => dispatch(action.hideModal(props))\n  };\n};\n\nconst mapStateToProps = (state, ownProps) => {\n  return {\n    modal: state.modal,\n    entyties: state.entyties\n  };\n};\n\nconst composedHoc = compose(connect(mapStateToProps, mapDispatchToProps), withMain);\nexport default composedHoc;","map":{"version":3,"sources":["/home/silasi/Deprojectos/javascript_projects/wiplay-it-web-frontend/src/containers/higher-order-components/main.js"],"names":["React","ModalManager","connect","compose","handleSubmit","getCurrentUser","getPost","getUserList","getUserProfile","getPostList","getQuestion","getReplyList","getReplyChildrenList","getQuestionList","_getQuestionList","getCommentList","getIndex","action","ModalOptionsMenu","DropImage","AppEditor","store","Modals","Helper","helper","withMain","Component","Main","constructor","props","onStoreUpdate","onStoreChange","storeUpdate","getState","openModal","modal","state","modalIsOpen","history","dispatch","hideModal","unsubscribe","subscribe","logout","localStorage","removeItem","isAuthenticated","push","close","modals","isOpen","modalProps","getProps","Object","assign","console","log","modalType","editorModal","setTimeout","setState","optionsMenuModal","dropImageModal","redirecToQuestionPage","questionObj","newObject","path","slug","currentUser","isNeQuestion","getItem","cachedEntyties","JSON","parse","auth","isLoggedIn","componentWillUnmount","disableBack","e","returnValue","preventDefault","componentDidMount","user","unfollowOrDownVote","params","objName","followers","obj","createFormData","upvotes","submit","followOrUpVote","pus","bind","render","mapDispatchToProps","ownProps","id","comment","reply","apiUrl","showModal","mapStateToProps","entyties","composedHoc"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AAEA,SAASC,YAAT,QAA4B,qBAA5B;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,OAAT,QAAwB,OAAxB;AACA,SAAQC,YAAR,EAAsBC,cAAtB,EAAqCC,OAArC,EAA8CC,WAA9C,EACSC,cADT,EACwBC,WADxB,EACoCC,WADpC,EACgDC,YADhD,EAC6DC,oBAD7D,EAESC,eAAe,IAAIC,gBAF5B,EAE6CC,cAF7C,EAE6DC,QAF7D,QAE8E,gBAF9E;AAGA,OAAQ,KAAKC,MAAb,MAA0B,wBAA1B;AAGA,SAASC,gBAAT,QAAiC,oBAAjC;AACA,SAASC,SAAT,QAA0B,iCAA1B;AACA,OAAOC,SAAP,MAAuB,mBAAvB;AACA,SAAQC,KAAR,QAAoB,OAApB;AAGA,OAAOC,MAAP,MAAmB,uBAAnB;AACA,OAAOC,MAAP,MAAmB,0BAAnB;AAKA,MAAMC,MAAM,GAAK,IAAID,MAAJ,EAAjB;AAGA,OAAO,SAASE,QAAT,CAAkBC,SAAlB,EAA6B;AAAA;;AAEjC,iBAAO,MAAMC,IAAN,SAAmBD,SAAnB,CAA6B;AAEjCE,IAAAA,WAAW,CAACC,MAAD,EAAQ;AAChB,YAAMA,MAAN;;AADgB,WA6ClBC,aA7CkB,GA6CF,MAAK;AAEnB,cAAMC,aAAa,GAAG,MAAM;AACzB,cAAIC,WAAW,GAAGX,KAAK,CAACY,QAAN,EAAlB,CADyB,CAEzB;AACA;AACE;AACH;AACC;;AACA,eAAKC,SAAL,CAAeF,WAAW,CAACG,KAA3B;;AAEA,cAAI,KAAKC,KAAL,CAAWC,WAAX,IAA0B,KAAKR,KAAL,CAAWS,OAAX,CAAmBrB,MAAnB,KAA8B,KAA5D,EAAmE;AAC/D,gBAAI,KAAKmB,KAAL,CAAWC,WAAf,EAA4B;AACxBhB,cAAAA,KAAK,CAACkB,QAAN,CAAetB,MAAM,CAACuB,SAAP,EAAf;AACH;AACJ,WAJD,MAMK,IAAI,KAAKX,KAAL,CAAWS,OAAX,IAAsB,KAAKT,KAAL,CAAWS,OAAX,CAAmBrB,MAAnB,KAA8B,MAAxD,EAAgE,CACjE;AACH;AACH,SAlBD;;AAoBA,aAAKwB,WAAL,GAAmBpB,KAAK,CAACqB,SAAN,CAAgBX,aAAhB,CAAnB;AAEF,OArEkB;;AAAA,WAgGrBY,MAhGqB,GAgGZ,MAAM;AAEXC,QAAAA,YAAY,CAACC,UAAb,CAAwB,kBAAxB;;AAEA,YAAI,KAAKC,eAAL,EAAJ,EAA4B;AACxBF,UAAAA,YAAY,CAACC,UAAb,CAAwB,kBAAxB;AACA,eAAKhB,KAAL,CAAWS,OAAX,CAAmBS,IAAnB,CAAwB,oBAAxB;AACH,SAHD,MAGK;AACJH,UAAAA,YAAY,CAACC,UAAb,CAAwB,kBAAxB;AACG,eAAKhB,KAAL,CAAWS,OAAX,CAAmBS,IAAnB,CAAwB,oBAAxB;AAEH;;AAED9C,QAAAA,YAAY,CAAC+C,KAAb;AACH,OA9GoB;;AAAA,WA4HrBd,SA5HqB,GA4HRC,KAAD,IAAW;AAClB;AACA;AACA;AACA,cAAMc,MAAM,GAAK,IAAI3B,MAAJ,EAAjB;;AACA,YAAIa,KAAK,CAACe,MAAV,EAAkB;AACf,cAAIC,UAAU,GAAGhB,KAAK,CAACgB,UAAN,GAAiBhB,KAAK,CAACgB,UAAvB,GAAkC,EAAnD,CADe,CAEf;;AACA,cAAItB,KAAK,GAAG,KAAKuB,QAAL,EAAZ;AACAC,UAAAA,MAAM,CAACC,MAAP,CAAczB,KAAd,EAAqBsB,UAArB;AAEAI,UAAAA,OAAO,CAACC,GAAR,CAAYrB,KAAZ;;AAEA,cAAIA,KAAK,CAACsB,SAAN,KAAoB,QAAxB,EAAkC;AAC/BN,YAAAA,UAAU,CAAC,eAAD,CAAV,GAA+B,oBAAC,SAAD,oBAAetB,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAA/B;AACA0B,YAAAA,OAAO,CAACC,GAAR,CAAYrB,KAAZ,EAAmBgB,UAAnB;AACAF,YAAAA,MAAM,CAACS,WAAP,CAAmBvB,KAAK,CAACgB,UAAzB;AACAQ,YAAAA,UAAU,CAAE,MAAM;AACd,mBAAKC,QAAL,CAAc;AAACvB,gBAAAA,WAAW,EAAG;AAAf,eAAd,EADc,CAEd;AACH,aAHS,EAGP,EAHO,CAAV;AAKF,WATD,MAUK,IAAGF,KAAK,CAACsB,SAAN,KAAoB,aAAvB,EAAqC;AACvCN,YAAAA,UAAU,CAAC,eAAD,CAAV,GAA8B,oBAAC,gBAAD,oBAAsBtB,KAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAA9B;AACAoB,YAAAA,MAAM,CAACY,gBAAP,CAAwBV,UAAxB;AAEAQ,YAAAA,UAAU,CAAE,MAAM;AACd,mBAAKC,QAAL,CAAc;AAACvB,gBAAAA,WAAW,EAAG;AAAf,eAAd,EADc,CAEd;AACH,aAHS,EAGP,EAHO,CAAV;AAKF,WATI,MAUA,IAAGF,KAAK,CAACsB,SAAN,KAAoB,WAAvB,EAAmC;AACrCN,YAAAA,UAAU,CAAC,eAAD,CAAV,GAA8B,oBAAC,SAAD,oBAAetB,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAA9B;AACAoB,YAAAA,MAAM,CAACa,cAAP,CAAsBX,UAAtB;AAEAQ,YAAAA,UAAU,CAAE,MAAM;AACd,mBAAKC,QAAL,CAAc;AAACvB,gBAAAA,WAAW,EAAG;AAAf,eAAd,EADc,CAEf;AACF,aAHS,EAGP,EAHO,CAAV;AAIF;AAGH,SAvCD,MAuCK;AACF,eAAKuB,QAAL,CAAc;AAACvB,YAAAA,WAAW,EAAE;AAAd,WAAd;AACApC,UAAAA,YAAY,CAAC+C,KAAb;AACF;AACH,OA5KkB;;AAAA,WA8KnBe,qBA9KmB,GA8KOC,WAAD,IAAiB;AACvCA,QAAAA,WAAW,GAAGA,WAAW,CAACC,SAA1B;;AACA,YAAID,WAAJ,EAAiB;AACd,cAAIE,IAAI,uBAAgBF,WAAW,CAACG,IAA5B,MAAR;AACA,cAAIC,WAAW,GAAG,KAAKhC,KAAL,CAAWgC,WAA7B;AAEA,eAAKvC,KAAL,CAAWS,OAAX,CAAmBS,IAAnB,CAAwBmB,IAAxB,EAA8B;AAACF,YAAAA,WAAD;AAAcI,YAAAA,WAAd;AAA2BC,YAAAA,YAAY,EAAC;AAAxC,WAA9B;AACF;AACH,OAtLkB;;AAGhB,WAAKjC,KAAL,GAAa;AACVgC,QAAAA,WAAW,EAAQ,EADT;AAEVtB,QAAAA,eAAe,EAAKF,YAAY,CAAC0B,OAAb,CAAqB,MAArB,IAA8B,IAA9B,GAAqC,KAF/C;AAGVjC,QAAAA,WAAW,EAAQ;AAHT,OAAb;AAMF;;AAGDS,IAAAA,eAAe,GAAG;AACjB,UAAIyB,cAAc,GAAGC,IAAI,CAACC,KAAL,CAAW7B,YAAY,CAAC0B,OAAb,CAAqB,kBAArB,CAAX,CAArB;;AAEC,UAAIC,cAAJ,EAAmB;AAAA,YACZG,IADY,GACDH,cADC,CACZG,IADY;;AAElB,YAAKA,IAAI,IAAIA,IAAI,CAACC,UAAlB,EAA6B;AAC5B,iBAAO,IAAP;AAEA;AACD;;AAED,aAAO,KAAP;AACD,KA1BgC,CA4BjC;AACG;AACD;AACF;AAGA;AACG;AACD;AACH;;AACC;;;;;;AAKAC,IAAAA,oBAAoB,GAAG;AACpB,WAAKnC,WAAL;AACF;;AA+BCoC,IAAAA,WAAW,CAACC,CAAD,EAAI;AACX,UAAI,KAAK1C,KAAL,CAAWC,WAAf,EAA4B;AACxByC,QAAAA,CAAC,CAACC,WAAF,GAAgB,EAAhB;AACH;;AAEDD,MAAAA,CAAC,CAACE,cAAF;AACH;;AAEDC,IAAAA,iBAAiB,GAAG;AACjB,WAAKnD,aAAL,GADiB,CACI;;AAExB,UAAI,CAAC,KAAKgB,eAAL,EAAL,EAA6B;AACzB;AACA,aAAKjB,KAAL,CAAWS,OAAX,CAAmBS,IAAnB,CAAwB,qBAAxB;AACH;;AAED,UAAG,CAAC,KAAK1C,cAAL,EAAJ,EAA0B;AACzBgB,QAAAA,KAAK,CAACkB,QAAN,CAAelC,cAAc,EAA7B;AACA;AACF;;AAmBHA,IAAAA,cAAc,GAAE;AACb,UAAIkE,cAAc,GAAGC,IAAI,CAACC,KAAL,CAAW7B,YAAY,CAAC0B,OAAb,CAAqB,kBAArB,CAAX,CAArB;;AAEA,UAAIC,cAAc,IAAIA,cAAc,CAACH,WAArC,EAAkD;AAC/C,eAAOG,cAAc,CAACH,WAAf,CAA2Bc,IAAlC;AACD;;AAED,aAAO,KAAP;AACD;;AAgEDC,IAAAA,kBAAkB,CAACC,MAAD,EAAS;AAExB,UAAIA,MAAM,CAACC,OAAP,KAAmB,UAAnB,IAAiCD,MAAM,CAACC,OAAP,KAAmB,aAApD,IAC0BD,MAAM,CAACC,OAAP,KAAmB,WADjD,EAC+D;AAC5D,YAAIC,SAAS,GAAOF,MAAM,CAACG,GAAP,CAAWD,SAAX,GAAuB,CAA3C;AAEAF,QAAAA,MAAM,CAAC,UAAD,CAAN,GAAqB5D,MAAM,CAACgE,cAAP,CAAsB;AAAEF,UAAAA;AAAF,SAAtB,CAArB;AACF,OALD,MAKK;AACF,YAAIG,OAAO,GAASL,MAAM,CAACG,GAAP,CAAWE,OAAX,GAAqB,CAAzC;AACAL,QAAAA,MAAM,CAAC,UAAD,CAAN,GAAqB5D,MAAM,CAACgE,cAAP,CAAsB;AAACC,UAAAA;AAAD,SAAtB,CAArB;AACF;;AACF,WAAK5D,KAAL,CAAW6D,MAAX,CAAkBN,MAAlB,EAXyB,CAWE;AAE5B;;AAEDO,IAAAA,cAAc,CAACP,MAAD,EAAS;AAEpB,UAAIA,MAAM,CAACC,OAAP,KAAmB,UAAnB,IAAiCD,MAAM,CAACC,OAAP,KAAmB,aAApD,IACmCD,MAAM,CAACC,OAAP,KAAmB,WAD1D,EACuE;AACpE,YAAIC,SAAS,GAAOF,MAAM,CAACG,GAAP,CAAWD,SAAX,GAAuB,CAA3C;AACAF,QAAAA,MAAM,CAAC,UAAD,CAAN,GAAqB5D,MAAM,CAACgE,cAAP,CAAsB;AAAEF,UAAAA;AAAF,SAAtB,CAArB;AACF,OAJD,MAIK;AACF,YAAIG,OAAO,GAASL,MAAM,CAACG,GAAP,CAAWE,OAAX,GAAqB,CAAzC;AACAL,QAAAA,MAAM,CAAC,UAAD,CAAN,GAAqB5D,MAAM,CAACgE,cAAP,CAAsB;AAACC,UAAAA;AAAD,SAAtB,CAArB;AACF;;AACF,WAAK5D,KAAL,CAAW6D,MAAX,CAAkBN,MAAlB,EAVqB,CAUM;AAE5B;;AAEDrC,IAAAA,IAAI,GAAE;AACJ,WAAKlB,KAAL,CAAWS,OAAX,CAAmBsD,GAAnB,CAAuB,KAAK/D,KAA5B,EAAmC,OAAnC;AACD;;AAEDuB,IAAAA,QAAQ,GAAE;AACP,UAAIvB,KAAK,GAAG;AACTc,QAAAA,MAAM,EAAe,KAAKA,MADjB;AAETgD,QAAAA,cAAc,EAAO,KAAKA,cAAL,CAAoBE,IAApB,CAAyB,IAAzB,CAFZ;AAGTV,QAAAA,kBAAkB,EAAG,KAAKA,kBAAL,CAAwBU,IAAxB,CAA6B,IAA7B,CAHZ;AAITzB,QAAAA,WAAW,EAAU,KAAK/D,cAAL;AAJZ,OAAZ;AAOAgD,MAAAA,MAAM,CAACC,MAAP,CAAczB,KAAd,EAAqB,KAAKA,KAA1B;AACA,aAAOA,KAAP;AAEF;;AAGDiE,IAAAA,MAAM,GAAG;AACN,UAAIjE,KAAK,GAAG,KAAKuB,QAAL,EAAZ;AACAG,MAAAA,OAAO,CAACC,GAAR,CAAY3B,KAAZ;AACA,aACK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,SAAD,oBAAeA,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SADF,CADL;AAMF;;AAlPgC,GAApC;AAqPF,C,CAGD;;AACA,MAAMkE,kBAAkB,GAAG,CAACxD,QAAD,EAAWyD,QAAX,KAAwB;AAE/C,SAAO;AACNhF,IAAAA,QAAQ,EAAe,MAAcuB,QAAQ,CAACvB,QAAQ,EAAT,CADvC;AAEHR,IAAAA,cAAc,EAAUyF,EAAD,IAAa1D,QAAQ,CAAC/B,cAAc,CAACyF,EAAD,CAAf,CAFzC;AAGH1F,IAAAA,WAAW,EAAasB,KAAD,IAAaU,QAAQ,CAAChC,WAAW,CAACsB,KAAD,CAAZ,CAHzC;AAIHhB,IAAAA,eAAe,EAASoF,EAAD,IAAa1D,QAAQ,CAACzB,gBAAgB,CAACmF,EAAD,CAAjB,CAJzC;AAKHxF,IAAAA,WAAW,EAAawF,EAAD,IAAa1D,QAAQ,CAAC9B,WAAW,CAACwF,EAAD,CAAZ,CALzC;AAMHvF,IAAAA,WAAW,EAAauF,EAAD,IAAa1D,QAAQ,CAAC7B,WAAW,CAACuF,EAAD,CAAZ,CANzC;AAOH3F,IAAAA,OAAO,EAAiB2F,EAAD,IAAa1D,QAAQ,CAACjC,OAAO,CAAC2F,EAAD,CAAR,CAPzC;AAQHlF,IAAAA,cAAc,EAAUmF,OAAD,IAAa3D,QAAQ,CAACxB,cAAc,CAACmF,OAAD,CAAf,CARzC;AASHvF,IAAAA,YAAY,EAAYkB,KAAD,IAAaU,QAAQ,CAAC5B,YAAY,CAACkB,KAAD,CAAb,CATzC;AAUHjB,IAAAA,oBAAoB,EAAIuF,KAAD,IAAa5D,QAAQ,CAAC3B,oBAAoB,CAACuF,KAAD,CAArB,CAVzC;AAWH9F,IAAAA,cAAc,EAAU+F,MAAD,IAAa7D,QAAQ,CAAClC,cAAc,EAAf,CAXzC;AAYHqF,IAAAA,MAAM,EAAkB7D,KAAD,IAAaU,QAAQ,CAACnC,YAAY,CAACyB,KAAD,CAAb,CAZzC;AAaHwE,IAAAA,SAAS,EAAexE,KAAD,IAAaU,QAAQ,CAACtB,MAAM,CAACoF,SAAP,CAAiBxE,KAAjB,CAAD,CAbzC;AAcHW,IAAAA,SAAS,EAAeX,KAAD,IAAaU,QAAQ,CAACtB,MAAM,CAACuB,SAAP,CAAiBX,KAAjB,CAAD;AAdzC,GAAP;AAiBH,CAnBD;;AAwBA,MAAMyE,eAAe,GAAG,CAAClE,KAAD,EAAQ4D,QAAR,KAAqB;AAEzC,SAAO;AACJ7D,IAAAA,KAAK,EAAWC,KAAK,CAACD,KADlB;AAEJoE,IAAAA,QAAQ,EAAQnE,KAAK,CAACmE;AAFlB,GAAP;AAIH,CAND;;AAQA,MAAMC,WAAW,GAAGrG,OAAO,CAAED,OAAO,CAACoG,eAAD,EAAkBP,kBAAlB,CAAT,EAA+CtE,QAA/C,CAA3B;AAGA,eAAgB+E,WAAhB","sourcesContent":["import React from 'react';\n\nimport { ModalManager} from 'react-dynamic-modal';\nimport { connect } from 'react-redux';\nimport { compose } from 'redux';\nimport {handleSubmit, getCurrentUser,getPost, getUserList,\n         getUserProfile,getPostList,getQuestion,getReplyList,getReplyChildrenList,\n         getQuestionList as _getQuestionList,getCommentList, getIndex }  from \"dispatch/index\"\nimport  * as action  from 'actions/actionCreators';\n\n\nimport { ModalOptionsMenu } from \"components/buttons\";\nimport { DropImage } from \"containers/profile/edit_profile\";\nimport AppEditor  from 'containers/editor'\nimport {store} from \"index\";\n\n\nimport Modals from \"containers/modal-conf\";\nimport Helper from 'containers/utils/helpers';\n\n\n\n\nconst helper   = new Helper();\n\n\nexport function withMain(Component) {\n\n   return class Main extends Component {\n\n      constructor(props) {\n         super(props);\n\n         this.state = {\n            currentUser      : '',\n            isAuthenticated  :  localStorage.getItem('auth' )?true : false,\n            modalIsOpen      : false,\n         };\n          \n      }\n\n\n      isAuthenticated() {\n      \tlet cachedEntyties = JSON.parse(localStorage.getItem('@@CachedEntyties'));\n        \n        if (cachedEntyties){\n        \tlet { auth  }  = cachedEntyties;\n        \tif ( auth && auth.isLoggedIn){\n        \t\treturn true\n                \n        \t}\n        }\n\n        return false;\n      }\n\n      //static getDerivedStateFromError(error) {\n         // Update state so the next render will show the fallback UI.\n        // return  dispatch => action.handleError(error);\n      //}\n\n      \n      //componentDidCatch(error, info) {\n         // You can also log the error to an error reporting service\n        // console.log(error, info);\n     // }\n      /*\n      componentWillMount() {\n        //localStorage.removeItem('questionList');        \n      }*/\n\n      componentWillUnmount() {\n         this.unsubscribe();\n      };\n\n       onStoreUpdate = () =>{\n \n         const onStoreChange = () => {\n            let storeUpdate = store.getState();\n            //if (!storeUpdate.question.visited && storeUpdate.question.newObject) {\n            //   console.log('redirecting to question page')\n              // this.redirecToQuestionPage(storeUpdate.question) \n           // }\n            //Open the Modal whenever modal is true.\n            this.openModal(storeUpdate.modal);\n\n            if (this.state.modalIsOpen && this.props.history.action === \"POP\") {\n                if (this.state.modalIsOpen) {\n                    store.dispatch(action.hideModal())\n                }\n            }\n\n            else if (this.props.history && this.props.history.action === \"PUSH\") {\n                //console.log(storeUpdate)\n            }\n         }\n\n         this.unsubscribe = store.subscribe(onStoreChange);\n\n      }\n\n        \n      \n\n        disableBack(e) {\n            if (this.state.modalIsOpen) {\n                e.returnValue = '';\n            }\n\n            e.preventDefault()\n        }\n\n        componentDidMount() {\n           this.onStoreUpdate() //Subscribe on store change    \n      \n        if (!this.isAuthenticated()) {\n            //User is not authenticated,so redirect to authentication page.\n            this.props.history.push('/user/registration/')\n        }\n\n        if(!this.getCurrentUser()){\n        \tstore.dispatch(getCurrentUser());\n        }\n      };\n\n\n    logout = () => {\n         \n        localStorage.removeItem('@@CachedEntyties')\n\n        if (this.isAuthenticated()) {\n            localStorage.removeItem('@@CachedEntyties')\n            this.props.history.push('/user/registration')\n        }else{\n        \tlocalStorage.removeItem('@@CachedEntyties')\n            this.props.history.push('/user/registration')\n\n        }\n\n        ModalManager.close();\n    }\n\n    getCurrentUser(){\n      \tlet cachedEntyties = JSON.parse(localStorage.getItem('@@CachedEntyties'));\n\n      \tif (cachedEntyties && cachedEntyties.currentUser) {\n      \t   return cachedEntyties.currentUser.user\n        }\n\n        return false;  \n      }\n\n\n\n    openModal = (modal) => {\n         //Open modal is open is true and close the if isOpen is false\n         //And most importantly render the modal with its contents based on the \n         //action dispatched \n         const modals   = new Modals();\n         if (modal.isOpen) {\n            let modalProps = modal.modalProps?modal.modalProps:{};\n            //Get Some important props and merge them with modalProps\n            let props = this.getProps()  \n            Object.assign(props, modalProps)\n\n            console.log(modal)\n\n            if (modal.modalType === 'editor') {\n               modalProps['modalContents'] =  <AppEditor {...props}/>;\n               console.log(modal, modalProps)\n               modals.editorModal(modal.modalProps);\n               setTimeout( () => {\n                   this.setState({modalIsOpen : true})\n                   //this.props.history.push({},'')\n               }, 10);\n               \n            }\n            else if(modal.modalType === 'optionsMenu'){\n               modalProps['modalContents'] = <ModalOptionsMenu {...props}/>\n               modals.optionsMenuModal(modalProps)\n\n               setTimeout( () => {\n                   this.setState({modalIsOpen : true})\n                   //this.props.history.push({},'')\n               }, 10);\n              \n            }\n            else if(modal.modalType === 'dropImage'){\n               modalProps['modalContents'] = <DropImage {...props}/>\n               modals.dropImageModal(modalProps)\n\n               setTimeout( () => {\n                   this.setState({modalIsOpen : true})\n                  //this.props.history.push({},'')\n               }, 10);\n            }\n        \n\n         }else{\n            this.setState({modalIsOpen: false})\n            ModalManager.close();\n         }\n      }\n     \n      redirecToQuestionPage  = (questionObj) => {\n         questionObj = questionObj.newObject;\n         if (questionObj) {\n            let path = `/question/${questionObj.slug}/` \n            let currentUser = this.state.currentUser;\n            \n            this.props.history.push(path, {questionObj, currentUser, isNeQuestion:true})\n         }\n      };\n      \n      unfollowOrDownVote(params) {\n        \n         if (params.objName === \"question\" || params.objName === \"userProfile\" \n                                    || params.objName === \"usersList\" ) {\n            var followers     = params.obj.followers - 1;\n\n            params['formData'] = helper.createFormData({ followers });\n         }else{\n            var upvotes       = params.obj.upvotes - 1; \n            params['formData'] = helper.createFormData({upvotes})\n         }\n        this.props.submit(params); //handle subimiting downVotes or Unfollwers \n\n      };\n\n      followOrUpVote(params) {\n      \n         if (params.objName === \"question\" || params.objName === \"userProfile\"\n                                             || params.objName === \"usersList\") {\n            var followers     = params.obj.followers + 1;\n            params['formData'] = helper.createFormData({ followers });\n         }else{\n            var upvotes       = params.obj.upvotes + 1; \n            params['formData'] = helper.createFormData({upvotes})\n         }\n        this.props.submit(params); //handle subimiting upvotes or follwers \n             \n      };\n\n      push(){\n        this.props.history.pus(this.props, 'hello') \n      }\n     \n      getProps(){\n         let props = {\n            logout             : this.logout,\n            followOrUpVote     : this.followOrUpVote.bind(this),\n            unfollowOrDownVote : this.unfollowOrDownVote.bind(this),\n            currentUser        : this.getCurrentUser(),\n         };\n         \n         Object.assign(props, this.props );\n         return props;  \n         \n      }\n  \n\n      render() {\n         let props = this.getProps();\n         console.log(props)\n         return (\n              <div>\n                <Component {...props}/>\n              </div> \n\n            );\n      };\n\n   }\n}\n\n\n//binds on `props` change\nconst mapDispatchToProps = (dispatch, ownProps) => {\n   \n    return {\n    \tgetIndex             : ()        =>  dispatch(getIndex()), \n        getUserProfile       : (id)      => dispatch(getUserProfile(id)),\n        getUserList          : (props)   => dispatch(getUserList(props)),\n        getQuestionList      : (id)      => dispatch(_getQuestionList(id)),\n        getPostList          : (id)      => dispatch(getPostList(id)),\n        getQuestion          : (id)      => dispatch(getQuestion(id)),\n        getPost              : (id)      => dispatch(getPost(id)),\n        getCommentList       : (comment) => dispatch(getCommentList(comment)),\n        getReplyList         : (props)   => dispatch(getReplyList(props)),\n        getReplyChildrenList : (reply)   => dispatch(getReplyChildrenList(reply)),\n        getCurrentUser       : (apiUrl)  => dispatch(getCurrentUser()),\n        submit               : (props )  => dispatch(handleSubmit(props)), \n        showModal            : (props )  => dispatch(action.showModal(props)),\n        hideModal            : (props )  => dispatch(action.hideModal(props)),  \n   }\n\n};\n\n\n\n\nconst mapStateToProps = (state, ownProps) => {\n   \n    return {\n       modal         : state.modal,\n       entyties      : state.entyties,       \n    }\n};\n\nconst composedHoc = compose( connect(mapStateToProps, mapDispatchToProps),withMain )\n\n\nexport default  composedHoc;\n\n\n\n\n"]},"metadata":{},"sourceType":"module"}